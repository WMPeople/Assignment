<?xml version="1.0" encoding="UTF-8" ?>
 
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
<mapper namespace="com.worksmobile.Assignment.Mapper.RecnetVersionMapper">
    <select id="getRecentVersion" parameterType = "int"
    resultType="com.worksmobile.Assignment.Domain.RecentVersionDTO">
		SELECT board_history_id, version, branch_id
		FROM recent_version
		WHERE board_history_id = #{board_history_id};
    </select>
    
    <delete id="deleteRecentVersion" parameterType="int">
		DELETE FROM recent_version
		WHERE board_history_id = #{board_history_id};
    </delete>

    <insert id="createRecentVersion" parameterType="com.worksmobile.Assignment.Domain.RecentVersionDTO">
        INSERT INTO recent_version(board_history_id, version, branch_id)
		VALUES(#{board_history_id}, #{version}, #{branch_id});
    </insert>

    <update id="updateRecentVersion" parameterType="com.worksmobile.Assignment.Domain.RecentVersionDTO">
		UPDATE recent_version
		SET
			version = #{version},
			branch_id = #{branch_id} 
		WHERE
			board_history_id = #{board_history_id};
    </update>

	<select id="getLastVersionHistoryId" resultType="int">
		SELECT board_history_id
		FROM recent_version
		ORDER BY board_history_id DESC
		LIMIT 1;
	</select>

</mapper>